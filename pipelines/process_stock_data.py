import yfinance as yf
import pandas as pd
from typing import List

sp500 = "MMM AOS ABT ABBV ABMD ACN ATVI ADBE AAP AMD AES AFL A APD AKAM ALK ALB ARE ALXN ALGN ALLE LNT ALL GOOGL GOOG MO AMZN AMCR AEE AAL AEP AXP AIG AMT AWK AMP ABC AME AMGN APH ADI ANSS ANTM AON APA AAPL AMAT APTV ADM ANET AJG AIZ T ATO ADSK ADP AZO AVB AVY BKR BLL BAC BAX BDX BRK.B BBY BIO BIIB BLK BA BKNG BWA BXP BSX BMY AVGO BR BF.B CHRW COG CDNS CPB COF CAH KMX CCL CARR CTLT CAT CBOE CBRE CDW CE CNC CNP CERN CF SCHW CHTR CVX CMG CB CHD CI CINF CTAS CSCO C CFG CTXS CME CMS KO CTSH CL CMCSA CMA CAG COP ED STZ CPRT GLW CTVA COST CCI CSX CMI CVS DHI DHR DRI DVA DE DAL XRAY DVN DXCM FANG DLR DFS DISCA DISCK DISH DG DLTR D DPZ DOV DOW DTE DUK DRE DD DXC EMN ETN EBAY ECL EIX EW EA EMR ENPH ETR EOG EFX EQIX EQR ESS EL ETSY RE EVRG ES EXC EXPE EXPD EXR XOM FFIV FB FAST FRT FDX FIS FITB FRC FE FISV FLT FLIR FLS FMC F FTNT FTV FBHS FOXA FOX BEN FCX GPS GRMN IT GD GE GIS GM GPC GILD GPN GL GS GWW HAL HBI HIG HAS HCA PEAK HSIC HES HPE HLT HFC HOLX HD HON HRL HST HWM HPQ HUM HBAN HII IEX IDXX INFO ITW ILMN INCY IR INTC ICE IBM IFF IP IPG INTU ISRG IVZ IPGP IQV IRM JBHT JKHY J SJM JNJ JCI JPM JNPR KSU K KEY KEYS KMB KIM KMI KLAC KHC KR LB LHX LH LRCX LW LVS LEG LDOS LEN LLY LNC LIN LYV LKQ LMT L LOW LUMN LYB MTB MRO MPC MKTX MAR MMC MLM MAS MA MXIM MKC MCD MCK MDT MRK MET MTD MGM MCHP MU MSFT MAA MHK TAP MDLZ MPWR MNST MCO MS MSI MSCI NDAQ NTAP NFLX NWL NEM NWSA NWS NEE NLSN NKE NI NSC NTRS NOC NLOK NCLH NOV NRG NUE NVDA NVR ORLY OXY ODFL OMC OKE ORCL OTIS PCAR PKG PH PAYX PAYC PYPL PNR PBCT PEP PKI PRGO PFE PM PSX PNW PXD PNC POOL PPG PPL PFG PG PGR PLD PRU PEG PSA PHM PVH QRVO QCOM PWR DGX RL RJF RTX O REG REGN RF RSG RMD RHI ROK ROL ROP ROST RCL SPGI CRM SBAC SLB STX SEE SRE NOW SHW SPG SWKS SLG SNA SO LUV SWK SBUX STT STE SYK SIVB SYF SNPS SYY TMUS TROW TTWO TPR TGT TEL TDY TFX TER TSLA TXN TXT BK CLX COO HSY MOS TRV DIS TMO TJX TSCO TT TDG TRMB TFC TWTR TYL TSN USB UDR ULTA UAA UA UNP UAL UPS URI UNH UHS UNM VLO VAR VTR VRSN VRSK VZ VRTX VFC VIAC VTRS V VNT VNO VMC WRB WBA WMT WM WAT WEC WFC WELL WST WDC WU WAB WRK WY WHR WMB WLTW WYNN XEL XRX XLNX XYL YUM ZBRA ZBH ZION ZTS"
keep_cols = ['Date', 'Adj Close']
hsi = ["1","2","3","4","5","6","8","10","11","12","14","16","17","19","23","27","35","41","59","66","69","81","83","86","87","95","101","116","119","120","123","135","136","142","144","148","151","152","165","168","173","175","177","178","179","189","200","215","220","241","242","256","257","267","268","270","272","285","288","291","293","297","302","303","308","315","322","323","327","336","337","338","341","345","347","354","358","363","371","384","386","388","390","392","405","410","425","435","440","460","467","468","486","489","493","496","506","512","520","522","535","546","548","551","552","563","570","576","581","586","590","598","604","631","636","639","656","658","659","665","667","669","670","683","686","688","694","696","697","698","699","700","728","743","751","753","754","762","763","772","777","778","780","788","799","806","808","813","817","819","823","826","832","836","839","853","855","856","857","861","867","868","874","880","881","883","884","902","909","914","916","934","939","941","960","966","968","973","978","981","991","992","998","1024","1030","1038","1044","1052","1055","1060","1066","1070","1071","1083","1088","1093","1098","1099","1109","1112","1113","1114","1117","1119","1128","1138","1141","1157","1171","1176","1177","1179","1186","1193","1196","1199","1208","1211","1212","1233","1234","1238","1257","1268","1269","1282","1288","1293","1299","1302","1308","1310","1313","1316","1317","1333","1336","1337","1339","1347","1357","1359","1368","1378","1381","1382","1383","1398","1448","1458","1475","1478","1508","1513","1515","1521","1528","1530","1548","1558","1569","1579","1585","1589","1600","1608","1610","1618","1622","1628","1638","1658","1666","1668","1675","1686","1691","1717","1728","1765","1766","1773","1776","1777","1778","1787","1788","1789","1797","1800","1801","1810","1811","1813","1816","1817","1818","1833","1836","1848","1860","1873","1876","1881","1882","1883","1888","1890","1896","1898","1907","1908","1910","1911","1913","1918","1919","1928","1929","1951","1958","1963","1966","1970","1972","1988","1995","1996","1997","1999","2001","2005","2007","2009","2013","2018","2019","2020","2038","2039","2048","2057","2103","2128","2186","2196","2202","2208","2233","2238","2269","2282","2313","2314","2318","2319","2328","2329","2331","2333","2338","2342","2343","2356","2357","2359","2380","2382","2386","2388","2400","2500","2588","2600","2601","2607","2611","2628","2638","2666","2669","2678","2688","2689","2727","2768","2772","2777","2778","2799","2858","2869","2877","2883","2899","3301","3306","3309","3311","3319","3320","3323","3328","3331","3333","3339","3360","3377","3380","3383","3396","3606","3613","3618","3633","3669","3690","3692","3759","3799","3800","3808","3813","3818","3836","3868","3877","3883","3888","3898","3899","3900","3908","3918","3933","3958","3968","3969","3988","3990","3993","3998","6030","6049","6055","6060","6066","6068","6069","6078","6088","6098","6099","6110","6158","6160","6166","6169","6185","6186","6618","6806","6808","6818","6823","6837","6855","6862","6869","6881","6886","6889","6969","9618","9633","9668","9688","9901","9909","9922","9923","9926","9928","9966","9968","9969","9983","9987","9988","9990","9996","9997","9999"]
kospi = '244920,140910,015260,078520,018250,298690,095570,006840,161000,001780,002790,090430,008700,007460,003060,002030,183190,020560,267850,002310,017900,155900,035150,027410,282330,352820,005180,030790,138930,000890,002760,026940,001270,003850,003000,002410,015350,011390,001460,007210,013700,006380,068270,012600,308170,002420,009310,033250,001560,030000,002780,100250,003780,051630,010640,001550,002600,018470,004700,004910,000950,185750,001630,120030,000480,000650,004920,001040,079160,097950,000120,011150,063160,031820,109070,192820,044820,005070,005420,021240,264900,005740,000590,112610,192400,284740,015590,012800,015230,000490,008060,353200,006370,084010,001130,003830,069460,016090,019680,005750,001880,006570,001680,084690,016710,117580,128820,006340,024890,000430,003220,009320,003090,069620,014160,008110,003540,009190,023590,058730,002880,000300,012030,000990,005830,016610,024090,145720,139130,034020,003160,001530,004890,092200,000210,375500,002150,028100,282690,002690,000640,170900,007590,004140,005960,001230,023450,026960,102260,005190,002210,000020,018500,049770,030720,006040,084670,092780,008970,000150,241560,336260,192080,012510,026890,004840,163560,192650,042670,042660,155660,069730,007340,016740,024900,004830,047040,014820,013570,210540,088260,017940,008250,093230,139480,011090,074610,365550,015020,001200,000700,084680,007700,036580,033180,081660,133820,010820,093370,016800,035000,011420,000500,006280,005250,011000,114090,013870,083420,078930,006360,001250,007070,037710,003530,241590,003010,195870,101530,014790,060980,293480,086790,009420,039130,005110,009460,014680,002390,143210,020000,014130,006390,300720,003300,002220,097230,180640,002320,000240,161390,123690,002960,025890,017960,008930,053690,128940,042700,011500,018880,105630,069640,016450,004960,011700,004150,009180,213500,010420,004710,009240,003680,000880,012450,000370,088350,009830,272210,001750,012630,039570,089470,294870,322000,003280,000540,003480,172580,153360,071090,000080,000140,019490,003350,011200,001500,000850,111110,025750,013520,082740,006060,008770,069260,005870,005010,079980,010660,032560,010690,002460,004800,298050,298000,298040,094280,298020,004560,267270,227840,267260,126560,267250,001450,004310,064350,004020,011210,307950,011760,069960,017800,000720,086280,005440,057050,079430,010620,005380,093240,024110,350520,334890,003560,000230,249420,008500,081000,103590,020150,020760,015860,003200,007110,013360,003120,007570,122900,014990,101140,034590,023810,214320,006490,129260,023800,010780,005950,007660,226320,033240,025620,175330,036420,271980,002620,006220,089590,010580,272450,088790,044380,348950,194370,096760,234080,001060,123890,035720,003490,000860,035250,105560,001620,029460,119650,009440,002380,344820,009070,281820,071320,092220,023350,006200,015760,052690,051600,130660,012200,016380,001390,000270,020120,071050,152550,168490,104700,001940,092440,002240,012170,039490,004540,071950,036460,161890,024720,002020,120110,144620,138490,003070,357120,005430,000970,007810,047810,003690,034830,025540,002200,010100,002140,005880,004090,010130,007280,006650,025000,092230,000040,010040,009540,044450,030200,053210,033780,030210,058850,058860,145270,001140,007690,005320,014530,002720,008870,214330,001210,002990,011780,073240,014280,001570,033270,017040,009290,013580,030610,339770,214390,000050,267290,012320,009450,009140,012610,002100,115390,025820,093050,003550,034220,108670,037560,011070,032640,051910,066570,051900,001120,079550,004990,011170,280360,286940,004000,071840,330590,023530,032350,005300,002270,000400,006260,229640,010120,000680,900140,204320,001080,027740,357250,094800,134380,138040,000060,008560,090370,023150,003650,025560,006800,085620,007120,268280,002840,088980,012330,204210,012690,005360,008420,009580,009200,009900,009680,033920,107590,017180,025860,001260,008350,004270,003920,035420,036570,251270,005720,002350,003580,338100,005940,181710,008260,034310,085310,009810,004370,072710,000320,090350,004250,138250,002630,010060,271560,001800,007310,006090,001340,003610,028670,007980,001020,950210,005690,090080,010770,017810,007630,103140,005810,005490,058430,003670,047050,005030,102460,000760,100840,036530,064960,003570,012750,075180,145210,058650,008040,007160,014710,006110,001470,004690,004450,000390,002450,004380,004440,000520,005500,009770,207940,028260,029780,032830,001360,068290,006400,018260,006660,005930,009150,028050,000810,010140,016360,001820,009470,011230,023000,272550,003230,000070,002170,003720,005680,002810,001290,041650,067830,001430,034120,101060,102280,023960,000180,010960,019440,003030,004360,027970,075580,033530,007540,248170,007610,011300,017390,004410,021050,007860,200880,091090,021820,013000,031440,001380,004490,005090,004060,002360,016590,293940,055550,004080,001770,002700,002870,019170,004170,035510,031430,034300,011930,005390,009270,001720,005800,134790,004970,009160,029530,006880,003960,123700,025530,034730,006120,000660,096770,068400,326030,011790,285130,210980,018670,001740,001510,017670,005850,010950,248070,336370,004430,017550,005610,003410,003620,306200,011810,071970,077970,008490,002820,003080,014910,004980,136490,004770,145990,003240,014580,006890,015890,001420,004100,009410,001440,001070,011280,055490,084870,002710,078000,015540,019180,001520,082640,002900,214420,001790,004870,091810,363280,072130,011330,014830,000910,047400,077500,096300,100220,002070,010600,016580,010050,008600,024070,005820,105840,049800,010400,016880,095720,033660,118000,004720,316140,017370,006980,317400,012280,015360,037270,002920,008730,014440,111770,009970,000670,006740,012160,070960,003470,000100,003460,003520,011690,000220,013890'
kospi = kospi.split(',')

def clean_csv(path_in: str, path_out: str, keep_cols: List[str]):
    df = pd.read_csv(path_in)
    df = df[keep_cols].fillna(method='ffill')
    return df.to_csv(path_out, index=False)

def clean():
    # for symbol in kospi:
    symbol = '^KS11'
    print(f'cleaning symbol {symbol} . . .')
    path_in = f'../raw/kospi/{symbol}.csv'
    path_out = f'../stock_data/kospi/{symbol}.csv'
    clean_csv(path_in, path_out, keep_cols)

if __name__ == '__main__':
    # main()
    clean()



