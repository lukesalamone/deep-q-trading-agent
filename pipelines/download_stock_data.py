import yfinance as yf

hsi = ["1","2","3","4","5","6","8","10","11","12","14","16","17","19","23","27","35","41","59","66","69","81","83","86","87","95","101","116","119","120","123","135","136","142","144","148","151","152","165","168","173","175","177","178","179","189","200","215","220","241","242","256","257","267","268","270","272","285","288","291","293","297","302","303","308","315","322","323","327","336","337","338","341","345","347","354","358","363","371","384","386","388","390","392","405","410","425","435","440","460","467","468","486","489","493","496","506","512","520","522","535","546","548","551","552","563","570","576","581","586","590","598","604","631","636","639","656","658","659","665","667","669","670","683","686","688","694","696","697","698","699","700","728","743","751","753","754","762","763","772","777","778","780","788","799","806","808","813","817","819","823","826","832","836","839","853","855","856","857","861","867","868","874","880","881","883","884","902","909","914","916","934","939","941","960","966","968","973","978","981","991","992","998","1024","1030","1038","1044","1052","1055","1060","1066","1070","1071","1083","1088","1093","1098","1099","1109","1112","1113","1114","1117","1119","1128","1138","1141","1157","1171","1176","1177","1179","1186","1193","1196","1199","1208","1211","1212","1233","1234","1238","1257","1268","1269","1282","1288","1293","1299","1302","1308","1310","1313","1316","1317","1333","1336","1337","1339","1347","1357","1359","1368","1378","1381","1382","1383","1398","1448","1458","1475","1478","1508","1513","1515","1521","1528","1530","1548","1558","1569","1579","1585","1589","1600","1608","1610","1618","1622","1628","1638","1658","1666","1668","1675","1686","1691","1717","1728","1765","1766","1773","1776","1777","1778","1787","1788","1789","1797","1800","1801","1810","1811","1813","1816","1817","1818","1833","1836","1848","1860","1873","1876","1881","1882","1883","1888","1890","1896","1898","1907","1908","1910","1911","1913","1918","1919","1928","1929","1951","1958","1963","1966","1970","1972","1988","1995","1996","1997","1999","2001","2005","2007","2009","2013","2018","2019","2020","2038","2039","2048","2057","2103","2128","2186","2196","2202","2208","2233","2238","2269","2282","2313","2314","2318","2319","2328","2329","2331","2333","2338","2342","2343","2356","2357","2359","2380","2382","2386","2388","2400","2500","2588","2600","2601","2607","2611","2628","2638","2666","2669","2678","2688","2689","2727","2768","2772","2777","2778","2799","2858","2869","2877","2883","2899","3301","3306","3309","3311","3319","3320","3323","3328","3331","3333","3339","3360","3377","3380","3383","3396","3606","3613","3618","3633","3669","3690","3692","3759","3799","3800","3808","3813","3818","3836","3868","3877","3883","3888","3898","3899","3900","3908","3918","3933","3958","3968","3969","3988","3990","3993","3998","6030","6049","6055","6060","6066","6068","6069","6078","6088","6098","6099","6110","6158","6160","6166","6169","6185","6186","6618","6806","6808","6818","6823","6837","6855","6862","6869","6881","6886","6889","6969","9618","9633","9668","9688","9901","9909","9922","9923","9926","9928","9966","9968","9969","9983","9987","9988","9990","9996","9997","9999"]

def main():
    for symbol in hsi:
        symbol = f'{ symbol.zfill(4) }.HK'
        print(f'downloading symbol { symbol } . . .')
        data = yf.download(symbol, start="1987-01-01", end="2017-12-31")
        data.to_csv(f'../raw/hsi/{symbol}.csv')

if __name__ == '__main__':
    main()